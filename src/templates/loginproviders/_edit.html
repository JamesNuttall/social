{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% set title = loginProvider.name %}

{% set crumbs = [
    { label: "Settings"|t('social'), url: url('settings') },
    { label: "Social"|t('social'), url: url('settings/social') },
    { label: "Login Providers"|t('social'), url: url('settings/social/loginproviders') },
] %}

{% set content %}

    <h2 class="first">{{ "Login Provider"|t('social') }}</h2>

    {% if loginProvider.iconUrl %}
        <img src="{{ loginProvider.iconUrl }}" height="48" />
    {% endif %}

    {% if loginProvider.isConfigured %}
        {% if loginProvider.isEnabled %}
            <p><span class="status on"></span> {{ "Social Login with {provider} is enabled"|t('social', { provider: loginProvider.name }) }}</p>
        {% else %}
            <p><span class="status"></span> {{ "Social Login with {provider} is disabled"|t('social', { provider: loginProvider.name }) }}</p>
            <p class="light">{{ "This login provider can be enabled by setting <strong><code>{providerHandle}LoginProvider.enabled</code></strong> to <strong><code>true</code></strong> in {path}"|t({
                providerHandle: loginProvider.handle,
                path: '<code>craft/config/social.php</code>'
            })|raw }}</p>
        {% endif %}

    {% else %}
        <p><span class="status"></span> {{ "Social Login with {provider} is disabled"|t('social', { provider: loginProvider.name }) }}</p>
        <p class="light">{{ "Social Login with {provider} is disabled because {oauthProviderLink} is not configured."|t('social', { provider: loginProvider.name, oauthProviderLink: '<a href="'~url('oauth/providers/'~loginProvider.handle)~'">{provider} OAuth provider</a>'|t({provider: loginProvider.name}) })|raw }}</p>
    {% endif %}

    <hr>

    <h2>{{ "Client"|t('social') }}</h2>

    <ul>
        <li><strong>Client ID:</strong> {{ loginProvider.infos.oauthProviderOptions.clientId ?? '' }}</li>
        <li><strong>Client Secret:</strong> {{ loginProvider.infos.oauthProviderOptions.clientSecret ?? '' }}</li>
        <li><strong>Redirect URI:</strong> {{ loginProvider.getRedirectUri() }}</li>
    </ul>

    <p class="light">{{ "Client ID & secret can be defined with <strong><code>{providerHandle}.clientId</code></strong> and <strong><code>{providerHandle}.clientSecret</code></strong> variable containing an array of permissions in: {path}."|t({
			provider: loginProvider.name,
			providerHandle: loginProvider.handle,
			path: '<code>craft/config/social.php</code>'
		})|raw }}</p>

    <hr>

    <h2>{{ "Scope"|t('social') }}</h2>

    {% if loginProvider.scope %}

        <p>{{ "{total} permission(s) defined:"|t('social', { total: loginProvider.scope|length }) }}</p>

        <ul class="bullets">
            {% for scope in loginProvider.scope %}
                <li>{{ scope }}</li>
            {% endfor %}
        </ul>
    {% else %}
        <p>{{ "No scope defined." }}</p>
    {% endif %}

    <p class="light">{{ "Scope expresses the permissions that users will get when they login with {provider}."|t('social', { provider: loginProvider.name }) }}</p>

    <p class="light">{{ "Default scope can be overridden by adding a <strong><code>{providerHandle}.scope</code></strong> variable containing an array of permissions in: {path}."|t({
        provider: loginProvider.name,
        providerHandle: loginProvider.handle,
        path: '<code>craft/config/social.php</code>'
    })|raw }}</p>

    {% if loginProvider.scopeDocsUrl %}
        <p class="light">
            <a href="{{ loginProvider.scopeDocsUrl }}" target="_blank">{{ "See available scopes for {provider}"|t('social', { provider: loginProvider.name }) }}</a>
        </p>
    {% endif %}


    <hr>

    <h2>{{ "Authorization Options"|t('social') }}</h2>

    {% if loginProvider.authorizationOptions %}
        <p>{{ "{total} authorization option(s) defined:"|t('social', { total: loginProvider.authorizationOptions|length }) }}</p>
        <ul class="bullets">
            {% for optionKey, optionValue in loginProvider.authorizationOptions %}
                <li><strong>{{ optionKey }}:</strong> {{ optionValue }} </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>{{ "No authorization options defined."|t('social') }}</p>
    {% endif %}

    <p class="light">{{ "Authorization options are extra parameters which are passed when logging in with {provider}."|t('social', { provider: loginProvider.name }) }}</p>

    <p class="light">{{ "Default authorization options can be overriden by adding a <strong><code>{providerHandle}.authorizationOptions</code></strong> variable containing a key/value array of authorization options in: {path}."|t({
        provider: loginProvider.name,
        providerHandle: loginProvider.handle,
        path: '<code>craft/config/social.php</code>'
    })|raw }}</p>


{% endset %}
